"use strict";angular.module("coq",["ngResource","ngSanitize"]),angular.module("coq").config(["$provide",function(a){a.decorator("$resource",function(a){var b=function(){var b=arguments[0],c=[],d=b.split("/"),e=a.apply(a,arguments);return angular.forEach(d,function(a){":"===a[0]&&c.push(a.substr(1))}),e.$$routeVariables=c,e};return b})}]),angular.module("coq").directive("CoqModel",function(){return{scope:{forUsers:"=",redirectPath:"@"},restrict:"A"}}),angular.module("coq").provider("Coq",function(){function a(a){return a}this.$conditionBuilder=a,this.$get=["$q",function(a){function b(a){angular.isObject(a)&&angular.forEach(a,function(a,b){angular.isFunction(a)||"$"===b[0]||-1===Object.keys(this.constructor.$attributesDefinition).indexOf(b)||(this[b]=a)},this),this.save=function(){return this.$resource.save(this.$toObject()).$promise},this.destroy=function(){return this.$resource["delete"](this.$toObject()).$promise},angular.isFunction(this.$resource.update)&&(this.update=function(){return this.$resource.$update({},this.$toObject()).$promise}),this.$toObject=function(){var a={};return angular.forEach(this,function(b,c){!angular.isFunction(b)&&this.hasOwnProperty(c)&&-1!==Object.keys(this.constructor.$attributesDefinition).indexOf(c)&&(a[c]=b)},this),a}}function c(b,c){b.find=function(d){var e=a.defer(),f={};if(b.$primaryKey||1!==b.$resource.$$routeVariables.length)b.$primaryKey&&(f[b.$primaryKey]=d);else{var g=!1;angular.forEach(b.$resource.$$routeVariables,function(a){angular.forEach(b.$attributesDefinition,function(b,c){a===c&&(g=c)})}),g&&(f[g]=d)}return Object.keys(f).length?c.get(f,function(a){var d=new b(a);d.$resource=c,e.resolve(d)},e.reject):e.reject(new Error("unable to locate primary key")),e.promise},b.where=function(d){var e=a.defer();return c.query(d,function(a){var d=[];angular.forEach(a,function(a){var e=new b(a);e.$resource=c,d.push(e)}),e.resolve(d)},e.reject),e.promise},b.all=function(){return b.where({})}}function d(a){function d(){d.superconstructor.apply(this,arguments)}if(!angular.isObject(a))throw new Error("config parameter missing");if(!a.$resource||!a.$resource.$$routeVariables)throw new Error("model declaration : resource object invalid");extend(d,b);var g=angular.copy(a);angular.forEach(a,function(a,b){-1!==e.indexOf(b)&&delete g[b]}),angular.extend(d.prototype,g);var h={};if(angular.isObject(a.$statics)&&(angular.forEach(a.$statics,function(a,b){-1===f.indexOf(b)&&(h[b]=a)}),angular.extend(d,h)),d.$resource=a.$resource,c(d,d.$resource),d.$attributesDefinition=a.$attributes||{},a.$primaryKey){if(-1===Object.keys(d.$attributesDefinition).indexOf(a.$primaryKey))throw new Error('$primaryKey "'+a.$primaryKey+'" not in $attributes');d.$primaryKey=a.$primaryKey}return d}var e=["$attributes","$statics","$primaryKey"],f=["find","all"];return{factory:d}}]});